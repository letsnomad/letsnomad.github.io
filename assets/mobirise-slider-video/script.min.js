!function(){function getVideoId(e){if("false"==e)return!1
var i=/(?:\?v=|\/embed\/|\.be\/)([-a-z0-9_]+)/i.exec(e)||/^([-a-z0-9_]+)$/i.exec(e)
return!!i&&i[1]}function getPreviewUrl(e,i){return"https://img.youtube.com/vi/"+e+"/"+(i||"")+"default.jpg"}var getPreviewUrlWithBestQuality=function(){var e={}
return function(i){var t=$.Deferred()
return i in e?e[i]?t.resolve(e[i]):t.reject("Preview image not found."):$("<img>").on("load",function(){if(120==(this.naturalWidth||this.width)){var r=this.src.split("/").pop()
switch(r){case"maxresdefault.jpg":this.src=this.src.replace(r,"sddefault.jpg")
break
case"sddefault.jpg":this.src=this.src.replace(r,"hqdefault.jpg")
break
case"hqdefault.jpg":this.src=this.src.replace(r,"default.jpg")
break
default:e[i]=null,t.reject("Preview image not found.")}}else t.resolve(e[i]=this.src)}).attr("src",getPreviewUrl(i,"maxres")),t}}()
$(document).on("add.cards change.cards",function(event){if($(event.target).hasClass("mbr-slider")){var isInit="add"==event.type,isDesktop=$("html").hasClass("desktop"),isBuilder=$("html").hasClass("is-builder")
$(event.target).outerFind("[data-bg-video-slide]").each(function(){isInit||$(".mbr-background-video-preview",this).remove()
var videoId=getVideoId($(this).attr("data-bg-video-slide"))
if(videoId){var $preview=$('<div class="mbr-background-video-preview"></div>').css({display:"none",backgroundSize:"cover",backgroundPosition:"center"})
if($(".mbr-overlay, .container-slide",this).before($preview),getPreviewUrlWithBestQuality(videoId).done(function(e){$preview.css("background-image",'url("'+e+'")').show()}),isInit&&isDesktop&&!isBuilder&&$.fn.YTPlayer&&!$(this).find(".playerBox").length){var params=eval("("+($(this).attr("data-bg-video-slide-params")||"{}")+")")
$(".container-slide",this).before('<div class="mbr-background-video"></div>').prev().YTPlayer($.extend({videoURL:videoId,containment:"self",showControls:!1,mute:!0},params))
var $overlay=$(this).find(".mbr-overlay")
$overlay.length&&$(".YTPOverlay",this).css({opacity:$overlay.css("opacity"),backgroundColor:$overlay.css("background-color")})}}}),isInit&&($(this).on("slide.bs.carousel","section.mbr-slider",function(e){$(e.target).find(".carousel-item.active .mb_YTPlayer").each(function(){$(this).YTPPause()}),$(e.target).find(".carousel-item:not(.active) iframe").css("opacity",0)}),$(this).on("slid.bs.carousel","section.mbr-slider",function(e){$(e.target).find(".carousel-item.active .mb_YTPlayer").each(function(){$(this).YTPPlay()}),$(e.target).find(".carousel-item.active iframe").resize().css("opacity",1)}))}})}()
