!function(){function f(e){return"false"!=e&&(!!(e=/(?:\?v=|\/embed\/|\.be\/)([-a-z0-9_]+)/i.exec(e)||/^([-a-z0-9_]+)$/i.exec(e))&&e[1])}var g=function(){var e={}
return function(a){var t=$.Deferred()
return a in e?e[a]?t.resolve(e[a]):t.reject("Preview image not found."):$("<img>").on("load",function(){if(120==(this.naturalWidth||this.width)){var i=this.src.split("/").pop()
switch(i){case"maxresdefault.jpg":this.src=this.src.replace(i,"sddefault.jpg")
break
case"sddefault.jpg":this.src=this.src.replace(i,"hqdefault.jpg")
break
case"hqdefault.jpg":this.src=this.src.replace(i,"default.jpg")
break
default:e[a]=null,t.reject("Preview image not found.")}}else t.resolve(e[a]=this.src)}).attr("src","https://img.youtube.com/vi/"+a+"/maxresdefault.jpg"),t}}()
$(document).on("add.cards change.cards",function(a){if($(a.target).hasClass("mbr-slider")){var b="add"==a.type,c=$("html").hasClass("desktop"),d=$("html").hasClass("is-builder")
$(a.target).outerFind("[data-bg-video-slide]").each(function(){b||$(".mbr-background-video-preview",this).remove()
var a=f($(this).attr("data-bg-video-slide"))
if(a){var e=$('<div class="mbr-background-video-preview"></div>').css({display:"none",backgroundSize:"cover",backgroundPosition:"center"})
if($(".mbr-overlay, .container-slide",this).before(e),g(a).done(function(a){e.css("background-image",'url("'+a+'")').show()}),b&&c&&!d&&$.fn.YTPlayer&&!$(this).find(".playerBox").length){var h=eval("("+($(this).attr("data-bg-video-slide-params")||"{}")+")")
$(".container-slide",this).before('<div class="mbr-background-video"></div>').prev().YTPlayer($.extend({videoURL:a,containment:"self",showControls:!1,mute:!0},h)),a=$(this).find(".mbr-overlay"),a.length&&$(".YTPOverlay",this).css({opacity:a.css("opacity"),backgroundColor:a.css("background-color")})}}}),b&&($(this).on("slide.bs.carousel","section.mbr-slider",function(e){$(e.target).find(".carousel-item.active .mb_YTPlayer").each(function(){$(this).YTPPause()}),$(e.target).find(".carousel-item:not(.active) iframe").css("opacity",0)}),$(this).on("slid.bs.carousel","section.mbr-slider",function(e){$(e.target).find(".carousel-item.active .mb_YTPlayer").each(function(){$(this).YTPPlay()}),$(e.target).find(".carousel-item.active iframe").resize().css("opacity",1)}))}})}()
