!function(e){function i(){clearTimeout(d),d=setTimeout(a,50)}function a(){var i=e(".mbr-gallery .modal")
if(i.length){var a=e(window).width()-0,t=e(window).height()-0
i.each(function(){var i,r
e(this).hasClass("in")
var l=e(this).find(".modal-dialog")
i=l.find(".carousel-item.active > img"),l.find(".carousel-item.prev > img, .carousel-item.next > img").length&&(i=l.find(".carousel-item.prev > img, .carousel-item.next > img").eq(0)),r=i[0].naturalWidth
var n=i[0].naturalHeight
i=a/t>r/n?(t-20)*r/n:a-20,i=i>=r?r:i,r=(t-i*n/r)/2,l.css({width:parseInt(i),top:r+0})})}}var t=e("html").hasClass("is-builder")
if(!t){var r=function(i){e(i.target).closest(".mbr-slider").hasClass("in")&&i.target.playVideo()},l=document.createElement("script")
l.src="https://www.youtube.com/iframe_api"
var n=document.getElementsByTagName("script")[0]
n.parentNode.insertBefore(l,n)
var o=[]
window.onYouTubeIframeAPIReady=function(){var i=i||{}
i.YTAPIReady||(i.YTAPIReady=!0,jQuery(document).trigger("YTAPIReady")),e(".video-slide").each(function(i){if(e(this).index(),e(this).closest("section"),e(".video-container").eq(i).append('<div id ="mbr-video-'+i+'" class="mbr-background-video" data-video-num="'+i+'"></div>').append('<div class="item-overlay"></div>'),e(this).attr("data-video-num",i),-1!=e(this).attr("data-video-url").indexOf("vimeo.com")){var a={id:e(this).attr("data-video-url"),width:"100%",height:"100%",loop:!0}
i=new Vimeo.Player("mbr-video-"+i,a),i.playVideo=Vimeo.play}else{var t,a=YT.Player
t=e(this).attr("data-video-url"),t="false"!=t&&(!!(t=/(?:\?v=|\/embed\/|\.be\/)([-a-z0-9_]+)/i.exec(t)||/^([-a-z0-9_]+)$/i.exec(t))&&t[1]),i=new a("mbr-video-"+i,{height:"100%",width:"100%",videoId:t,events:{onReady:r},playerVars:{rel:0}})}o.push(i)})}}e(document).on("add.cards change.cards",function(i){var a=e(i.target),r=a.find(".mbr-gallery-filter-all")
if(a.hasClass("mbr-slider-carousel")){var l=[]
if(a.find(".mbr-gallery-item").each(function(i){(e(this).attr("data-tags")||"").trim().split(",").map(function(i){i=i.trim(),-1==e.inArray(i,l)&&l.push(i)})}),0<a.find(".mbr-gallery-filter").length&&e(i.target).find(".mbr-gallery-filter").hasClass("gallery-filter-active")){var n=""
a.find(".mbr-gallery-filter ul li:not(li:eq(0))").remove(),l.map(function(e){n+="<li>"+e+"</li>"}),a.find(".mbr-gallery-filter ul").append(r).append(n),a.on("click",".mbr-gallery-filter li",function(i){$li=e(this),$li.parent().find("li").removeClass("active"),$li.addClass("active")
var t=$li.closest("section").find(".mbr-gallery-row"),r=$li.html().trim()
a.find(".mbr-gallery-item").each(function(i,a){var t=e(this)
tagsTrimmed=t.attr("data-tags").split(",").map(function(e){return e.trim()}),-1!=e.inArray(r,tagsTrimmed)||$li.hasClass("mbr-gallery-filter-all")?t.removeClass("mbr-gallery-item__hided"):(t.addClass("mbr-gallery-item__hided"),setTimeout(function(){t.css("left","300px")},200))}),setTimeout(function(){t.closest(".mbr-gallery-row").trigger("filter")},50)})}else a.find(".mbr-gallery-item__hided").removeClass("mbr-gallery-item__hided"),a.find(".mbr-gallery-row").trigger("filter")
t||a.find(".video-slide").each(function(i){e(this).closest(".mbr-gallery-item").index()}),void 0!==e.fn.masonry&&a.outerFind(".mbr-gallery").each(function(){var i=e(this).find(".mbr-gallery-row").masonry({itemSelector:".mbr-gallery-item:not(.mbr-gallery-item__hided)",percentPosition:!0})
i.masonry("reloadItems"),i.on("filter",function(){i.masonry("reloadItems"),i.masonry("layout"),e(window).trigger("update.parallax")}.bind(this,i)),i.imagesLoaded().progress(function(){i.masonry("layout")})})}}),e(".mbr-gallery-item").on("click","a",function(e){e.stopPropagation()})
var d,l=e(document).find(".mbr-gallery")
l.on("show.bs.modal",function(a){clearTimeout(t)
var t=setTimeout(function(){var i=e(a.relatedTarget).parent().index(),i=e(a.target).find(".carousel-item").eq(i).find(".mbr-background-video")
e(a.target).find(".carousel-item .mbr-background-video"),0<i.length&&(i=o[+i.attr("data-video-num")],i.playVideo?i.playVideo():i.play())},500)
i()}),l.on("slide.bs.carousel",function(i){i=e(i.target).find(".carousel-item.active .mbr-background-video"),0<i.length&&(i=o[+i.attr("data-video-num")],i.pauseVideo?i.pauseVideo():i.pause())}),e(window).on("resize load",i),l.on("slid.bs.carousel",function(a){a=e(a.target).find(".carousel-item.active .mbr-background-video"),0<a.length&&(a=o[+a.attr("data-video-num")],a.playVideo?a.playVideo():a.play()),i()}),l.on("hide.bs.modal",function(e){o.map(function(e,i){e.pauseVideo?e.pauseVideo():e.pause()})})}(jQuery)
