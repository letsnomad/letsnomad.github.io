!function(e){function i(e){if("false"==e)return!1
var i=/(?:\?v=|\/embed\/|\.be\/)([-a-z0-9_]+)/i.exec(e)||/^([-a-z0-9_]+)$/i.exec(e)
return!!i&&i[1]}function a(i){e(i.target).closest(".mbr-slider").hasClass("in")&&i.target.playVideo()}function t(){clearTimeout(s),s=setTimeout(r,50)}function r(){var i=e(".mbr-gallery .modal")
if(i.length){var a=e(window).width()-0,t=e(window).height()-0
i.each(function(){var i,r,l=(e(this).hasClass("in"),e(this).find(".modal-dialog")),n=l.find(".carousel-item.active > img")
l.find(".carousel-item.prev > img, .carousel-item.next > img").length&&(n=l.find(".carousel-item.prev > img, .carousel-item.next > img").eq(0))
var o=n[0].naturalWidth,d=n[0].naturalHeight
if(a/t>o/d){i=(t-20)*o/d}else i=a-20
i=i>=o?o:i,r=(t-i*d/o)/2,l.css({width:parseInt(i),top:r+0})})}}var l=e("html").hasClass("is-builder")
if(!l){var n=document.createElement("script")
n.src="https://www.youtube.com/iframe_api"
var o=document.getElementsByTagName("script")[0]
o.parentNode.insertBefore(n,o)
var d=[]
window.onYouTubeIframeAPIReady=function(){var t=t||{}
t.YTAPIReady||(t.YTAPIReady=!0,jQuery(document).trigger("YTAPIReady")),e(".video-slide").each(function(t){e(this).index(),e(this).closest("section")
if(e(".video-container").eq(t).append('<div id ="mbr-video-'+t+'" class="mbr-background-video" data-video-num="'+t+'"></div>').append('<div class="item-overlay"></div>'),e(this).attr("data-video-num",t),-1!=e(this).attr("data-video-url").indexOf("vimeo.com")){var r={id:e(this).attr("data-video-url"),width:"100%",height:"100%",loop:!0},l=new Vimeo.Player("mbr-video-"+t,r)
l.playVideo=Vimeo.play}else var l=new YT.Player("mbr-video-"+t,{height:"100%",width:"100%",videoId:i(e(this).attr("data-video-url")),events:{onReady:a},playerVars:{rel:0}})
d.push(l)})}}e(document).on("add.cards change.cards",function(i){var a=e(i.target),t=a.find(".mbr-gallery-filter-all")
if(a.hasClass("mbr-slider-carousel")){var r=[]
if(a.find(".mbr-gallery-item").each(function(i){(e(this).attr("data-tags")||"").trim().split(",").map(function(i){var a=i.trim();-1==e.inArray(a,r)&&r.push(a)})}),a.find(".mbr-gallery-filter").length>0&&e(i.target).find(".mbr-gallery-filter").hasClass("gallery-filter-active")){var n=""
a.find(".mbr-gallery-filter ul li:not(li:eq(0))").remove(),r.map(function(e){n+="<li>"+e+"</li>"}),a.find(".mbr-gallery-filter ul").append(t).append(n),a.on("click",".mbr-gallery-filter li",function(i){$li=e(this),$li.parent().find("li").removeClass("active"),$li.addClass("active")
var t=$li.closest("section").find(".mbr-gallery-row"),r=$li.html().trim()
a.find(".mbr-gallery-item").each(function(i,a){var t=e(this),l=t.attr("data-tags"),n=l.split(",")
tagsTrimmed=n.map(function(e){return e.trim()}),-1!=e.inArray(r,tagsTrimmed)||$li.hasClass("mbr-gallery-filter-all")?t.removeClass("mbr-gallery-item__hided"):(t.addClass("mbr-gallery-item__hided"),setTimeout(function(){t.css("left","300px")},200))}),setTimeout(function(){t.closest(".mbr-gallery-row").trigger("filter")},50)})}else a.find(".mbr-gallery-item__hided").removeClass("mbr-gallery-item__hided"),a.find(".mbr-gallery-row").trigger("filter")
l||a.find(".video-slide").each(function(i){e(this).closest(".mbr-gallery-item").index()}),void 0!==e.fn.masonry&&a.outerFind(".mbr-gallery").each(function(){var i=e(this).find(".mbr-gallery-row").masonry({itemSelector:".mbr-gallery-item:not(.mbr-gallery-item__hided)",percentPosition:!0})
i.masonry("reloadItems"),i.on("filter",function(){i.masonry("reloadItems"),i.masonry("layout"),e(window).trigger("update.parallax")}.bind(this,i)),i.imagesLoaded().progress(function(){i.masonry("layout")})})}}),e(".mbr-gallery-item").on("click","a",function(e){e.stopPropagation()})
var s,m=e(document).find(".mbr-gallery")
m.on("show.bs.modal",function(i){clearTimeout(a)
var a=setTimeout(function(){var a=e(i.relatedTarget).parent().index(),t=e(i.target).find(".carousel-item").eq(a).find(".mbr-background-video")
if(e(i.target).find(".carousel-item .mbr-background-video"),t.length>0){var r=d[+t.attr("data-video-num")]
r.playVideo?r.playVideo():r.play()}},500)
t()}),m.on("slide.bs.carousel",function(i){var a=e(i.target).find(".carousel-item.active .mbr-background-video")
if(a.length>0){var t=d[+a.attr("data-video-num")]
t.pauseVideo?t.pauseVideo():t.pause()}}),e(window).on("resize load",t),m.on("slid.bs.carousel",function(i){var a=e(i.target).find(".carousel-item.active .mbr-background-video")
if(a.length>0){var r=d[+a.attr("data-video-num")]
r.playVideo?r.playVideo():r.play()}t()}),m.on("hide.bs.modal",function(e){d.map(function(e,i){e.pauseVideo?e.pauseVideo():e.pause()})})}(jQuery)
